# 问题背景与目标

## 设计日期
2026-02-03

---

## 问题定义

### 核心问题

对于**开发中期的项目**，当开启新的 AI 对话时，AI 无法快速理解项目的逻辑结构，导致：

- 需要大量时间探索代码库
- 实现需求时可能不够准确
- 可能创建重复功能或违反项目约定

### 目标

创建一个**通用的、编辑器无关的、AI 驱动的自动化系统**，为任意项目维护一份"项目逻辑地图"，让 AI 在新对话中能够快速理解项目并上手工作。

---

## 设计原则

### 1. 编辑器无关
- ❌ 不依赖特定 IDE（VSCode、Cursor、JetBrains 等）
- ❌ 不依赖特定 AI 模型（Claude、GPT、Gemini 等）
- ✅ 使用通用的 Markdown 格式
- ✅ 使用标准的文件路径约定

### 2. AI 驱动判断
- ❌ 不使用硬编码的代码解析规则
- ❌ 不依赖语言特定的 AST 解析
- ✅ 让 AI 理解变更的语义含义
- ✅ Subagent 基于自然语言规则做决策

### 3. 代码共存
- ❌ 不将模块文档集中存放在单独目录
- ✅ 模块文档与代码目录共存
- ✅ 文档跟随代码移动（重构友好）
- ✅ 提高文档的可发现性

### 4. 职责驱动
- 文档核心：清楚描述每个目录/模块**负责什么**
- 不是需求文档，不是变更日志
- 是项目逻辑结构的**当前状态快照**

### 5. 自动化维护
- 用户只提需求，系统自动维护文档
- 基于 Git Hook 触发，无需人工记忆
- 增量更新，不重新生成

---

## 技术约束

### 开发约束
- **Python 版本**: 3.6+（仅使用标准库）
- **跨平台**: macOS/Linux/Windows
- **性能**: Git hook 执行应在 5 秒内完成

### 文档约束
- **格式**: Markdown
- **大小**: MAP.md < 20KB，_AI_CONTEXT.md < 10KB
- **命名**: `_AI_CONTEXT.md`（下划线前缀，便于排序）

### Git 约束
- **非侵入**: 文档更新失败不应阻断 commit
- **原子性**: 文档更新应与代码变更在同一 commit
- **可选**: 可通过配置禁用自动更新
